!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("ng-modal-lib",["exports","@angular/core","@angular/common","rxjs","rxjs/operators"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["ng-modal-lib"]={},e.ng.core,e.ng.common,e.rxjs,e.rxjs.operators)}(this,(function(e,t,i,n,o){"use strict";function s(e){return"touchstart"===e.type||"mousedown"===e.type&&0===e.button}function r(e){return"touchend"===e.type||"touchcancel"===e.type?e.changedTouches[0]:e.type.startsWith("touch")?e.targetTouches[0]:e}var a=function(){function e(e){this.element=e,this.scrollTopEnable=!0,this.backdrop=!0,this.closeModal=new t.EventEmitter}return e.prototype.ngAfterViewChecked=function(){this.executePostDisplayActions&&(this.center(),this.executePostDisplayActions=!1)},e.prototype.onKeyDown=function(e){e.preventDefault(),e.stopPropagation(),this.hide()},e.prototype.onWindowResize=function(){this.executePostDisplayActions=!0,this.center()},e.prototype.show=function(){var e=this;this.executePostDisplayActions=!0,this.visible=!0,setTimeout((function(){e.modalRoot.nativeElement.focus(),e.scrollTopEnable&&(e.modalBody.nativeElement.scrollTop=0)}),1)},e.prototype.hide=function(){this.visible=!1,this.closeModal.emit(!0),this.focusLastModal()},e.prototype.center=function(){var e=this.modalRoot.nativeElement.offsetWidth,t=this.modalRoot.nativeElement.offsetHeight;0===e&&0===t&&(this.modalRoot.nativeElement.style.visibility="hidden",this.modalRoot.nativeElement.style.display="block",e=this.modalRoot.nativeElement.offsetWidth,t=this.modalRoot.nativeElement.offsetHeight,this.modalRoot.nativeElement.style.display="none",this.modalRoot.nativeElement.style.visibility="visible");var i=Math.max((window.innerWidth-e)/2,0),n=Math.max((window.innerHeight-t)/2,0);this.modalRoot.nativeElement.style.left=i+"px",this.modalRoot.nativeElement.style.top=n+"px"},e.prototype.initDrag=function(e){e.target!==this.closeIcon.nativeElement&&(this.maximized||(this.dragEventTarget=e))},e.prototype.onResize=function(e){"vertical"===e.direction&&this.calcBodyHeight()},e.prototype.calcBodyHeight=function(){var e=this.modalHeader.nativeElement.offsetHeight+this.modalFooter.nativeElement.offsetHeight,t=this.modalRoot.nativeElement.offsetHeight-e;this.modalBody.nativeElement.style.height=t+"px",this.modalBody.nativeElement.style.maxHeight="none"},e.prototype.getMaxModalIndex=function(){return void 0===(e=".ui-modal")&&(e="body *"),Array.from(document.querySelectorAll(e)).map((function(e){return parseFloat(window.getComputedStyle(e).zIndex)})).filter((function(e){return!isNaN(e)})).sort((function(e,t){return e-t})).pop()||0;var e},e.prototype.focusLastModal=function(){var e=function(e,t){if("function"==typeof e.closest)return e.closest(t)||null;for(;e;){if(e.matches(t))return e;e=e.parentElement}return null}(this.element.nativeElement.parentElement,".ui-modal");e&&e.focus()},e.prototype.toggleMaximize=function(e){this.maximized?this.revertMaximize():this.maximize(),e.preventDefault()},e.prototype.maximize=function(){this.preMaximizePageX=parseFloat(this.modalRoot.nativeElement.style.top),this.preMaximizePageY=parseFloat(this.modalRoot.nativeElement.style.left),this.preMaximizeRootWidth=this.modalRoot.nativeElement.offsetWidth,this.preMaximizeRootHeight=this.modalRoot.nativeElement.offsetHeight,this.preMaximizeBodyHeight=this.modalBody.nativeElement.offsetHeight,this.modalRoot.nativeElement.style.top="0px",this.modalRoot.nativeElement.style.left="0px",this.modalRoot.nativeElement.style.width="100vw",this.modalRoot.nativeElement.style.height="100vh";var e=this.modalHeader.nativeElement.offsetHeight+this.modalFooter.nativeElement.offsetHeight;this.modalBody.nativeElement.style.height="calc(100vh - "+e+"px)",this.modalBody.nativeElement.style.maxHeight="none",this.maximized=!0},e.prototype.revertMaximize=function(){this.modalRoot.nativeElement.style.top=this.preMaximizePageX+"px",this.modalRoot.nativeElement.style.left=this.preMaximizePageY+"px",this.modalRoot.nativeElement.style.width=this.preMaximizeRootWidth+"px",this.modalRoot.nativeElement.style.height=this.preMaximizeRootHeight+"px",this.modalBody.nativeElement.style.height=this.preMaximizeBodyHeight+"px",this.maximized=!1},e.prototype.moveOnTop=function(){if(!this.backdrop){var e=this.getMaxModalIndex(),t=parseFloat(window.getComputedStyle(this.modalRoot.nativeElement).zIndex)||0;t<=e&&(t=e+1,this.modalRoot.nativeElement.style.zIndex=t.toString())}},e}();a.decorators=[{type:t.Component,args:[{selector:"app-modal",template:'<div class="ui-modal-overlay" [style.display]="(visible && backdrop) ? \'block\' : \'none\'"></div>\n\n<div class="ui-modal" tabindex="-1" role="dialog"\n     #modalRoot\n     appResizable\n     [south]="true"\n     [east]="true"\n     [southEast]="true"\n     [southWest]="true"\n     [west]="true"\n     [northWest]="true"\n     [north]="true"\n     [northEast]="true"\n     (resizing)="onResize($event)"\n     appDraggable\n     [dragEventTarget]="dragEventTarget"\n     [inViewport]="inViewport"\n     [style.display]="visible ? \'block\' : \'none\'"\n     (mousedown)="moveOnTop()"\n     (touchstart)="moveOnTop()">\n    <div class="ui-modal-header" #modalHeader\n         (mousedown)="initDrag($event)"\n         (touchstart)="initDrag($event)">\n      <div class="ui-titlebar">\n          <ng-content select=".app-modal-header"></ng-content>\n      </div>\n      <div class="ui-controlbar">\n          <i class="ui-icon"\n             *ngIf="maximizable"\n             (click)="toggleMaximize($event)"\n             [ngClass]="{\'dt-icon-maximize\': !maximized, \'dt-icon-normalize\': maximized}">\n          </i>\n          <i class="ui-icon dt-icon-close" #closeIcon (click)="hide()">\n          </i>\n      </div>\n    </div>\n\n    <div class="ui-modal-body" #modalBody>\n      <ng-content select=".app-modal-body"></ng-content>\n    </div>\n    <div class="ui-modal-footer" #modalFooter>\n      <ng-content select=".app-modal-footer"></ng-content>\n    </div>\n</div>\n',encapsulation:t.ViewEncapsulation.None,styles:['.ui-modal *,.ui-modal :after,.ui-modal :before{box-sizing:border-box}.ui-modal,.ui-modal-overlay{z-index:10}.ui-modal-overlay{background-color:rgba(0,0,0,.2);height:100%;width:100%}.ui-modal,.ui-modal-overlay{display:none;left:0;position:fixed;top:0}.ui-modal{background-color:#fff;box-shadow:0 .25rem .5rem 0 rgba(0,0,0,.2),0 .375rem 1.25rem 0 rgba(0,0,0,.19);min-height:12.5rem;min-width:16.25rem;outline:none;padding:0;width:31.25rem}.ui-modal-header{-webkit-user-select:none;align-items:center;background-color:var(--dt-color-primary,#5b9bd5);color:#fff;display:flex;flex-direction:row;flex-wrap:nowrap;padding:.5rem 1rem;position:relative;user-select:none}.ui-modal-body{-webkit-overflow-scrolling:touch;max-height:calc(100vh - 12.5rem);overflow-y:auto;padding:.625rem 1rem;position:relative}.ui-modal-footer{padding:1rem}.ui-titlebar{flex-grow:1;font-size:1.125rem;height:100%;overflow:hidden}.ui-controlbar,.ui-titlebar{align-items:center;display:flex}.ui-controlbar{background-color:inherit}.ui-icon{cursor:pointer;font-size:1.4rem;margin-left:.3em}.ui-icon:hover{opacity:.75}.dragging{-webkit-user-select:none;box-shadow:0 .25rem .5rem rgba(102,175,233,.6),0 .375rem 1.25rem rgba(0,0,0,.2);cursor:move;outline:0;user-select:none}.dt-icon-maximize{background-color:initial;border:.1em solid;border-top:.2em solid}.dt-icon-maximize,.dt-icon-normalize{display:inline-block;height:1em;position:relative;width:1em}.dt-icon-normalize{background-color:inherit}.dt-icon-normalize:after,.dt-icon-normalize:before{background-color:inherit;border:.1em solid;content:"";height:.8em;position:absolute;width:.8em}.dt-icon-normalize:before{right:0;top:0}.dt-icon-normalize:after{border-top-width:.2em;bottom:0;left:0}.dt-icon-close{background-color:initial;display:inline-block;height:1em;position:relative;width:1em}.dt-icon-close:after,.dt-icon-close:before{background-color:currentColor;content:"";height:.18em;left:50%;position:absolute;top:50%;width:1.2em}.dt-icon-close:before{transform:translate(-50%,-50%) rotate(-225deg)}.dt-icon-close:after{transform:translate(-50%,-50%) rotate(225deg)}.resize-handle-e{cursor:e-resize;height:100%;position:absolute;right:-.3125rem;top:0;width:.4375rem}.resize-handle-se{bottom:0;cursor:se-resize;height:1rem;position:absolute;right:0;width:1rem}.resize-handle-s{bottom:-.3125rem;cursor:s-resize;height:.4375rem;left:0;position:absolute;width:100%}.resize-handle-sw{bottom:0;cursor:sw-resize;height:7px;height:15px;left:0;position:absolute;width:15px}.resize-handle-w{cursor:w-resize;height:100%;left:-5px;position:absolute;top:0;width:7px}.resize-handle-nw{cursor:nw-resize;height:7px;height:15px;left:0;position:absolute;top:0;width:15px}.resize-handle-n{cursor:n-resize;height:7px;left:0;position:absolute;top:-5px;width:95%}.resize-handle-ne{cursor:ne-resize;height:7px;height:15px;position:absolute;right:0;top:0;width:15px}.resizing{-webkit-user-select:none;user-select:none}']}]}],a.ctorParameters=function(){return[{type:t.ElementRef}]},a.propDecorators={scrollTopEnable:[{type:t.Input}],maximizable:[{type:t.Input}],backdrop:[{type:t.Input}],inViewport:[{type:t.Input}],closeModal:[{type:t.Output}],modalRoot:[{type:t.ViewChild,args:["modalRoot",{static:!1}]}],modalBody:[{type:t.ViewChild,args:["modalBody",{static:!1}]}],modalHeader:[{type:t.ViewChild,args:["modalHeader",{static:!1}]}],modalFooter:[{type:t.ViewChild,args:["modalFooter",{static:!1}]}],closeIcon:[{type:t.ViewChild,args:["closeIcon",{static:!1}]}],onKeyDown:[{type:t.HostListener,args:["keydown.esc",["$event"]]}],onWindowResize:[{type:t.HostListener,args:["window:resize"]}]};var h=function(){function e(e){this.resizeBegin=new t.EventEmitter,this.resizing=new t.EventEmitter,this.resizeEnd=new t.EventEmitter,this.element=e.nativeElement}return e.prototype.ngAfterViewInit=function(){this.south&&this.createHandle("resize-handle-s"),this.east&&this.createHandle("resize-handle-e"),this.southEast&&this.createHandle("resize-handle-se"),this.southWest&&this.createHandle("resize-handle-sw"),this.west&&this.createHandle("resize-handle-w"),this.northWest&&this.createHandle("resize-handle-nw"),this.north&&this.createHandle("resize-handle-n"),this.northEast&&this.createHandle("resize-handle-ne");var e=window.getComputedStyle(this.element);this.minWidth=parseFloat(e.minWidth),this.maxWidth=parseFloat(e.maxWidth),this.minHeight=parseFloat(e.minHeight),this.maxHeight=parseFloat(e.maxHeight)},e.prototype.ngOnDestroy=function(){this.destroySubscription()},e.prototype.onMousedown=function(e){var t=this;if(s(e)){var i=e.target.classList,a=i.contains("resize-handle-s"),h=i.contains("resize-handle-e"),l=i.contains("resize-handle-se"),d=i.contains("resize-handle-sw"),m=i.contains("resize-handle-w"),p=i.contains("resize-handle-nw"),c=i.contains("resize-handle-n"),u=i.contains("resize-handle-ne"),g=r(e),f=this.element.clientWidth,v=this.element.clientHeight,y=this.element.offsetLeft,w=this.element.offsetTop,z=g.screenX,E=g.screenY,b=e.type.startsWith("touch"),x=b?"touchmove":"mousemove",H=b?"touchend":"mouseup";if(a||h||l||d||m||p||c||u){this.initResize(e,a,h,l,d,m,p,c,u);var W=n.fromEvent(document,H);this.subscription=W.subscribe((function(e){return t.onMouseup(e)}));var M=n.fromEvent(document,x).pipe(o.takeUntil(W)).subscribe((function(e){return t.move(e,f,v,w,y,z,E)}));this.subscription.add(M)}}},e.prototype.move=function(e,t,i,n,o,s,a){var h=r(e),l=h.screenX-s,d=h.screenY-a;this.newWidth=t-(this.resizingSW||this.resizingW||this.resizingNW?l:-l),this.newHeight=i-(this.resizingNW||this.resizingN||this.resizingNE?d:-d),this.newLeft=o+l,this.newTop=n+d,this.resizeWidth(h),this.resizeHeight(h)},e.prototype.onMouseup=function(e){this.endResize(e),this.destroySubscription()},e.prototype.destroySubscription=function(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0)},e.prototype.createHandle=function(e){var t=document.createElement("span");t.className=e,this.element.appendChild(t)},e.prototype.initResize=function(e,t,i,n,o,s,r,a,h){t&&(this.resizingS=!0),i&&(this.resizingE=!0),n&&(this.resizingSE=!0),o&&(this.resizingSW=!0),s&&(this.resizingW=!0),r&&(this.resizingNW=!0),a&&(this.resizingN=!0),h&&(this.resizingNE=!0),this.element.classList.add("resizing"),this.newWidth=this.element.clientWidth,this.newHeight=this.element.clientHeight,this.newLeft=this.element.offsetLeft,this.newTop=this.element.offsetTop,e.stopPropagation(),this.resizeBegin.emit()},e.prototype.endResize=function(e){this.resizingS=!1,this.resizingE=!1,this.resizingSE=!1,this.resizingSW=!1,this.resizingW=!1,this.resizingNW=!1,this.resizingN=!1,this.resizingNE=!1,this.element.classList.remove("resizing"),this.resizeEnd.emit({event:r(e),width:this.newWidth,height:this.newHeight})},e.prototype.resizeWidth=function(e){var t=!this.minWidth||this.newWidth>=this.minWidth,i=!this.maxWidth||this.newWidth<=this.maxWidth;(this.resizingSE||this.resizingE||this.resizingNE)&&t&&i&&(this.ghost||(this.element.style.width=this.newWidth+"px")),(this.resizingSW||this.resizingW||this.resizingNW)&&t&&i&&(this.element.style.left=this.newLeft+"px",this.element.style.width=this.newWidth+"px"),this.resizing.emit({event:e,width:this.newWidth,height:this.newHeight,direction:"horizontal"})},e.prototype.resizeHeight=function(e){var t=!this.minHeight||this.newHeight>=this.minHeight,i=!this.maxHeight||this.newHeight<=this.maxHeight;(this.resizingSE||this.resizingS||this.resizingSW)&&t&&i&&(this.ghost||(this.element.style.height=this.newHeight+"px")),(this.resizingNW||this.resizingN||this.resizingNE)&&t&&i&&(this.ghost||(this.element.style.top=this.newTop+"px",this.element.style.height=this.newHeight+"px")),this.resizing.emit({event:e,width:this.newWidth,height:this.newHeight,direction:"vertical"})},e}();h.decorators=[{type:t.Directive,args:[{selector:"[appResizable]"}]}],h.ctorParameters=function(){return[{type:t.ElementRef}]},h.propDecorators={south:[{type:t.Input}],east:[{type:t.Input}],southEast:[{type:t.Input}],ghost:[{type:t.Input}],southWest:[{type:t.Input}],west:[{type:t.Input}],northWest:[{type:t.Input}],north:[{type:t.Input}],northEast:[{type:t.Input}],resizeBegin:[{type:t.Output}],resizing:[{type:t.Output}],resizeEnd:[{type:t.Output}],onMousedown:[{type:t.HostListener,args:["mousedown",["$event"]]},{type:t.HostListener,args:["touchstart",["$event"]]}]};var l=function(){};l.decorators=[{type:t.NgModule,args:[{declarations:[h],exports:[h]}]}];var d=function(){function e(e,i){this.element=e,this.ngZone=i,this.dragX=!0,this.dragY=!0,this.dragStart=new t.EventEmitter,this.dragMove=new t.EventEmitter,this.dragEnd=new t.EventEmitter,this.globalListeners=new Map}return e.prototype.ngOnChanges=function(e){e.dragEventTarget&&e.dragEventTarget.currentValue&&this.onMousedown(this.dragEventTarget)},e.prototype.ngOnDestroy=function(){this.removeEventListener()},e.prototype.onMousedown=function(e){if(s(e)&&(this.dragX||this.dragY)){var t=r(e);this.initDrag(t.pageX,t.pageY),this.addEventListeners(e),this.dragStart.emit(e)}},e.prototype.onMousemove=function(e){var t=r(e);this.onDrag(t.pageX,t.pageY),this.dragMove.emit(e)},e.prototype.onMouseup=function(e){this.endDrag(),this.removeEventListener(),this.dragEnd.emit(e)},e.prototype.addEventListeners=function(e){var t=this,i=e.type.startsWith("touch"),n=i?"touchmove":"mousemove",o=i?"touchend":"mouseup";this.globalListeners.set(n,{handler:this.onMousemove.bind(this),options:!1}).set(o,{handler:this.onMouseup.bind(this),options:!1}),this.ngZone.runOutsideAngular((function(){t.globalListeners.forEach((function(e,t){window.document.addEventListener(t,e.handler,e.options)}))}))},e.prototype.removeEventListener=function(){this.globalListeners.forEach((function(e,t){window.document.removeEventListener(t,e.handler,e.options)}))},e.prototype.initDrag=function(e,t){this.isDragging=!0,this.lastPageX=e,this.lastPageY=t,this.element.nativeElement.classList.add("dragging"),this.elementWidth=this.element.nativeElement.offsetWidth,this.elementHeight=this.element.nativeElement.offsetHeight,this.vw=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),this.vh=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)},e.prototype.onDrag=function(e,t){if(this.isDragging){var i=e-this.lastPageX,n=t-this.lastPageY,o=this.element.nativeElement.getBoundingClientRect(),s=o.left+i,r=o.top+n,a=!this.inViewport||s>=0&&s+this.elementWidth<=this.vw,h=!this.inViewport||r>=0&&r+this.elementHeight<=this.vh;a&&(this.lastPageX=e),h&&(this.lastPageY=t),this.inViewport&&(s<0&&(s=0),s+this.elementWidth>this.vw&&(s=this.vw-this.elementWidth),r<0&&(r=0),r+this.elementHeight>this.vh&&(r=this.vh-this.elementHeight)),this.element.nativeElement.style.left=s+"px",this.element.nativeElement.style.top=r+"px"}},e.prototype.endDrag=function(){this.isDragging=!1,this.element.nativeElement.classList.remove("dragging")},e}();d.decorators=[{type:t.Directive,args:[{selector:"[appDraggable]"}]}],d.ctorParameters=function(){return[{type:t.ElementRef},{type:t.NgZone}]},d.propDecorators={dragEventTarget:[{type:t.Input}],dragX:[{type:t.Input}],dragY:[{type:t.Input}],inViewport:[{type:t.Input}],dragStart:[{type:t.Output}],dragMove:[{type:t.Output}],dragEnd:[{type:t.Output}]};var m=function(){};m.decorators=[{type:t.NgModule,args:[{declarations:[d],exports:[d]}]}];var p=function(){};p.decorators=[{type:t.NgModule,args:[{imports:[i.CommonModule,l,m],declarations:[a],exports:[a]}]}],e.ModalComponent=a,e.ModalModule=p,e.ɵa=l,e.ɵb=h,e.ɵc=m,e.ɵd=d,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ng-modal-lib.umd.min.js.map